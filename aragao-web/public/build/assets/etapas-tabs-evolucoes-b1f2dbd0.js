Alpine.data("etapasTabEvolucoes",()=>({infoEvolucao:null,modalInfoEvolucao:!1,modalImageSrc:null,modalImage:null,carregarImagens(){document.querySelector("div.app-loading").classList.remove("hidden");let a=this.infoEvolucao.imagens;this.infoEvolucao.imagens=[];const o=a.map(l=>axios.get("/home/imagens/arquivo/"+l.id).then(e=>(e.data&&e.data.url&&(l.url=e.data.url),l)).catch(e=>(console.error("Erro ao carregar a URL da imagem:",e),l)));o.forEach(l=>{l.then(e=>{const i=a.findIndex(t=>t.id===e.id);i!==-1&&(a[i]=e)})}),this.infoEvolucao.imagens=a,Promise.all(o).then(()=>{document.querySelector("div.app-loading").classList.add("hidden")})},setInfoEvolucao(a){this.infoEvolucao=a,this.modalInfoEvolucao=!0,this.carregarImagens()},setModalImage(a){this.modalImageSrc=a,this.modalImage=!0},closeModal(a){a().inputs.id_etapa=null,a().inputs.dt_evolucao=null,a().inputs.descricao=null,a().inputsImages=[],this.infoEvolucao=null,a().editId=null,a().modal=!1},setEditModal(a,o){o().inputs.id_etapa=a.id_etapa,o().inputs.dt_evolucao=a.dt_evolucao,o().inputs.descricao=a.descricao,this.infoEvolucao=a,o().editId=a.id,o().modal=!0,this.carregarImagens()},exclurEvolucao(a,o){this.$store.dialog.show("Excluir evolução","Você realmente deseja excluir essa evolução?",{cancel:{},confirm:{text:"Sim, excluir!",action:()=>o().excluirEvolucao(a.id)}})},exclurImagem(a,o){this.$store.dialog.show("Excluir imagem","Você realmente deseja excluir essa imagem?",{cancel:{},confirm:{text:"Sim, excluir!",action:()=>o().excluirImagem(a)}})}}));
